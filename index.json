[{"authors":["admin"],"categories":null,"content":"Eu sou um entusiasta da análise de dados e Engenheiro Florestal formado pela ESALQ/USP.\nMeu currículo completo está disponível aqui.\n","date":-62135596800,"expirydate":-62135596800,"kind":"taxonomy","lang":"en","lastmod":-62135596800,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"https://edgarcutar.github.io/authors/admin/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/authors/admin/","section":"authors","summary":"Eu sou um entusiasta da análise de dados e Engenheiro Florestal formado pela ESALQ/USP.\nMeu currículo completo está disponível aqui.","tags":null,"title":"Edgar Cutar Junior","type":"authors"},{"authors":[],"categories":["Estatística","Pareamento"],"content":"\rQuando falamos em bases de dados, existem basicamente dois grandes tipos de dados: Transversais e Longitudinais.\nDados transversais (também chamados de cross-section) são o tipo de dado mais comum encontrado em qualquer área de estudo. Nesse tipo de base, existe uma observação para cada “indivíduo”. Como uma fotografia, ou um recorte, da população a ser estudada, um dado transversal tenta captar as variações que ocorrem na população através de uma imagem estática.\nUm grande exemplo de dado transversal é a base de dados starwars do pacote dplyr:\nif (!require(\u0026quot;pacman\u0026quot;)) install.packages(\u0026quot;pacman\u0026quot;)\r## Carregando pacotes exigidos: pacman\rpacman::p_load(tidyverse, datasets)\rdplyr::starwars\r## # A tibble: 87 x 13\r## name height mass hair_color skin_color eye_color birth_year gender\r## \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; ## 1 Luke~ 172 77 blond fair blue 19 male ## 2 C-3PO 167 75 \u0026lt;NA\u0026gt; gold yellow 112 \u0026lt;NA\u0026gt; ## 3 R2-D2 96 32 \u0026lt;NA\u0026gt; white, bl~ red 33 \u0026lt;NA\u0026gt; ## 4 Dart~ 202 136 none white yellow 41.9 male ## 5 Leia~ 150 49 brown light brown 19 female\r## 6 Owen~ 178 120 brown, gr~ light blue 52 male ## 7 Beru~ 165 75 brown light blue 47 female\r## 8 R5-D4 97 32 \u0026lt;NA\u0026gt; white, red red NA \u0026lt;NA\u0026gt; ## 9 Bigg~ 183 84 black light brown 24 male ## 10 Obi-~ 182 77 auburn, w~ fair blue-gray 57 male ## # ... with 77 more rows, and 5 more variables: homeworld \u0026lt;chr\u0026gt;,\r## # species \u0026lt;chr\u0026gt;, films \u0026lt;list\u0026gt;, vehicles \u0026lt;list\u0026gt;, starships \u0026lt;list\u0026gt;\rEssa base mostra uma série de dados (altura, peso, cor de cabelo, pele e olhos) de diversos personagens da franquia Star Wars. Cada personagem aparece apenas uma vez (com exceção de Anakin Skywalker/Darth Vader, que aparece como dois personagens, mas divago).\nO outro tipo de dado é o “longitudinal”. Nesse tipo de estudo, os dados são coletados repetidamente para ao mesmo indivíduo. Olhando para a base do Star Wars, se tivessemos dados da vida dos personagens, ela se tornaria longitudinal Por exemplo, teríamos dados do Luke Skywalker com seu peso e altura em diversas fases da sua vida.\nUma base longitudinal, como você deve imaginar, é muito mais complicada de se obter, mas permite análises também mais complexas. É possível determinar tipos de crescimento, entender comportamentos antes/depois de certos acontecimentos (resposta a um remédio, sobrevida depois de uma cirurgia, medições de variáveis climáticas ao redor do globo). Conseguir uma base longitudinal leva tempo e custa caro, mas existem determinadas aplicações que necessitam desse tipo de dado.\nDentro da área florestal, existe um uso específico que exige dados longitudinais: os modelos de crescimento florestal. Para que seja possível entender os padrões de crescimento de um povoamento florestal, é preciso que sejam coletadas amostras de um determinado conjunto de árvores repetidamente ao longo do tempo.\nDessa forma, ficamos com uma base de dados como a abaixo:\nparcela \u0026lt;- read_csv2(\u0026quot;https://raw.githubusercontent.com/edgarcutar/example_data/master/parcelas.csv\u0026quot;)\r## Using \u0026#39;,\u0026#39; as decimal and \u0026#39;.\u0026#39; as grouping mark. Use read_delim() for more control.\r## Parsed with column specification:\r## cols(\r## parcela_amostral = col_character(),\r## idade = col_double(),\r## volume = col_double(),\r## area_basal = col_double(),\r## altura_dominante = col_double()\r## )\rparcela\r## # A tibble: 9 x 5\r## parcela_amostral idade volume area_basal altura_dominante\r## \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 A 2 53.7 9.9 12.9\r## 2 A 3 131 17.4 19.4\r## 3 A 4 220. 23.2 24.1\r## 4 B 2 93.8 14.4 15.8\r## 5 B 3 163. 18.7 20.9\r## 6 B 4 217. 21.1 25.4\r## 7 C 2 59.5 10.4 14.9\r## 8 C 3 122. 15.3 19.8\r## 9 C 4 175. 18.2 24.4\rNesse caso, existem medições da mesma parcela amostral ao longo de 3 anos. Com esse tipo de dado é possível construir um modelo de crescimento e produção para aquele tipo de floresta.\nPara que seja possível construir um modelo desse tipo, existe um passo extra necessário, é necessário organizar pares de observações, em linha, de forma a parear estas bases de forma a conseguir ajustar um modelo do tipo \\(Vol_2 \\sim 1 + I_2 + Vol_1 + I_1\\), ou seja, um Volume no tempo 2 em função da idade no tempo 2, volume no tempo 1 e idade no tempo 1.\nUm exemplo desse tipo de modelo é o de Lundqvist-Korf, em que uma de suas equações diferenciais pode ser escrita do seguinte modo:\n\\(Vol_2 = a*(Vol_1/a)^(I_1/I_2)^c\\)\nPara que seja possível ter uma base pronta para esse ajuste, é necessário que seja feito o pareamento dos dados, ou seja, cada idade deve ser combinada às demais. É basicamente uma combinatória com algumas regras:\n\rDevem ser pareadas apenas as mesmas medições das parcelas;\rA idade 2 deve ser maior que a idade 1;\r\rPara fazer essa combinatória, elaborei uma função de pareamento, apresentada abaixo e aplicada aos dados do nosso exemplo. Apesar de ter pensado ela para dados florestais, a mesma pode ser usada com poucas modificações para quaisquer origem de dados.\nA função terá 3 argumentos: - table: o data frame a ser pareado - id: o identificador único de sua parcela amostral - idade: sua variável indicando o tempo de medição. Pode ser idade, ano, mês… a coluna que indica QUANDO a medição foi feita, em relação ao \\(t_0\\).\npacman::p_load(dplyr)\rpareamento \u0026lt;- function(table, id, idade){\rexpand.grid.df \u0026lt;- function(...) Reduce(function(...) merge(..., by=NULL), list(...)) #Cria Função combinatória\rid_ \u0026lt;- sym(deparse(substitute(id))) #transforma inputs em strings e depois em objetos\ridade1 \u0026lt;- sym(str_c(deparse(substitute(idade)), \u0026quot;.x\u0026quot;))\ridade2 \u0026lt;- sym(str_c(deparse(substitute(idade)), \u0026quot;.y\u0026quot;))\rpar_unique \u0026lt;- unique(table %\u0026gt;%\rpull(!!id_))\routput \u0026lt;- vector(\u0026quot;list\u0026quot;, length(par_unique)) # cria output de listas vazio\rp \u0026lt;- progress_estimated(length(par_unique)) # Cria barra de progresso\rfor (i in seq_along(par_unique)) {\ra \u0026lt;- table %\u0026gt;% filter(!!id_ == par_unique[i]) #filtra parcela i\rb \u0026lt;- expand.grid.df(a,a) #combinatória de parcela amostral\rc \u0026lt;- b %\u0026gt;% filter(!!idade2 \u0026gt; !!idade1) #separa i2 \u0026gt; i1\routput[[i]] \u0026lt;- c # cria lista i com output p$tick()$print() #print barra de progresso\r}\rbind_rows(output) #combina output em um único data frame\r}\r#Aplicando a função a nosso exemplo\rparcela %\u0026gt;% pareamento(id = parcela_amostral, idade = idade)\r## parcela_amostral.x idade.x volume.x area_basal.x altura_dominante.x\r## 1 A 2 53.7 9.9 12.9\r## 2 A 2 53.7 9.9 12.9\r## 3 A 3 131.0 17.4 19.4\r## 4 B 2 93.8 14.4 15.8\r## 5 B 2 93.8 14.4 15.8\r## 6 B 3 163.1 18.7 20.9\r## 7 C 2 59.5 10.4 14.9\r## 8 C 2 59.5 10.4 14.9\r## 9 C 3 121.9 15.3 19.8\r## parcela_amostral.y idade.y volume.y area_basal.y altura_dominante.y\r## 1 A 3 131.0 17.4 19.4\r## 2 A 4 219.6 23.2 24.1\r## 3 A 4 219.6 23.2 24.1\r## 4 B 3 163.1 18.7 20.9\r## 5 B 4 217.3 21.1 25.4\r## 6 B 4 217.3 21.1 25.4\r## 7 C 3 121.9 15.3 19.8\r## 8 C 4 174.8 18.2 24.4\r## 9 C 4 174.8 18.2 24.4\rPode parecer um processo trivial pra uma função tão longa, mas já vi muita gente quebrando cabeça e fazendo macros enormes pra chegar nesse resultado.\nFalei alguma groselha ou tem algum jeito menos maluco de fazer isso? Me avise no twitter!\nAbraços!\n","date":1565481600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1565560170,"objectID":"b8c09301c26bd7f6b2d1216a6b40bb44","permalink":"https://edgarcutar.github.io/post/2019-08-11-longitudinal/longitudinal/","publishdate":"2019-08-11T00:00:00Z","relpermalink":"/post/2019-08-11-longitudinal/longitudinal/","section":"post","summary":"Quando falamos em bases de dados, existem basicamente dois grandes tipos de dados: Transversais e Longitudinais.\nDados transversais (também chamados de cross-section) são o tipo de dado mais comum encontrado em qualquer área de estudo. Nesse tipo de base, existe uma observação para cada “indivíduo”. Como uma fotografia, ou um recorte, da população a ser estudada, um dado transversal tenta captar as variações que ocorrem na população através de uma imagem estática.","tags":["longitudinal","crescimento","forestry"],"title":"Lidando com dados longitudinais e pareamento de dados","type":"post"},{"authors":null,"categories":[],"content":"\rA Tidy Tuesday dessa semana traz um dataset sobre Bob Ross. Bob foi um pintor americano conhecido pelo programa The Joy of Painting, que foi ao ar nos anos 80 e 90 nos EUA, Canadá e Europa. No seu programa, ele mostrava técnicas de pintura a óleo enquanto completava uma pintura toda semana.\nO dataset sobre o trabalho de Bob Ross foi fornecido para a #tidytuesday pelo site 538:\nif (!require(\u0026quot;pacman\u0026quot;)) install.packages(\u0026quot;pacman\u0026quot;)\rpacman::p_load(tidyverse, janitor)\rbob_ross \u0026lt;- readr::read_csv(\u0026quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-08-06/bob-ross.csv\u0026quot;) %\u0026gt;% clean_names()\rEm primeiro lugar, para ver o que temos nos dados, vamos usar a função head, que retorna as primeiras linhas da planilha:\nbob_ross %\u0026gt;% head()\r## # A tibble: 6 x 69\r## episode title apple_frame aurora_borealis barn beach boat bridge\r## \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 S01E01 \u0026quot;\\\u0026quot;A~ 0 0 0 0 0 0\r## 2 S01E02 \u0026quot;\\\u0026quot;M~ 0 0 0 0 0 0\r## 3 S01E03 \u0026quot;\\\u0026quot;E~ 0 0 0 0 0 0\r## 4 S01E04 \u0026quot;\\\u0026quot;W~ 0 0 0 0 0 0\r## 5 S01E05 \u0026quot;\\\u0026quot;Q~ 0 0 0 0 0 0\r## 6 S01E06 \u0026quot;\\\u0026quot;W~ 0 0 0 0 0 0\r## # ... with 61 more variables: building \u0026lt;dbl\u0026gt;, bushes \u0026lt;dbl\u0026gt;, cabin \u0026lt;dbl\u0026gt;,\r## # cactus \u0026lt;dbl\u0026gt;, circle_frame \u0026lt;dbl\u0026gt;, cirrus \u0026lt;dbl\u0026gt;, cliff \u0026lt;dbl\u0026gt;,\r## # clouds \u0026lt;dbl\u0026gt;, conifer \u0026lt;dbl\u0026gt;, cumulus \u0026lt;dbl\u0026gt;, deciduous \u0026lt;dbl\u0026gt;,\r## # diane_andre \u0026lt;dbl\u0026gt;, dock \u0026lt;dbl\u0026gt;, double_oval_frame \u0026lt;dbl\u0026gt;, farm \u0026lt;dbl\u0026gt;,\r## # fence \u0026lt;dbl\u0026gt;, fire \u0026lt;dbl\u0026gt;, florida_frame \u0026lt;dbl\u0026gt;, flowers \u0026lt;dbl\u0026gt;,\r## # fog \u0026lt;dbl\u0026gt;, framed \u0026lt;dbl\u0026gt;, grass \u0026lt;dbl\u0026gt;, guest \u0026lt;dbl\u0026gt;,\r## # half_circle_frame \u0026lt;dbl\u0026gt;, half_oval_frame \u0026lt;dbl\u0026gt;, hills \u0026lt;dbl\u0026gt;,\r## # lake \u0026lt;dbl\u0026gt;, lakes \u0026lt;dbl\u0026gt;, lighthouse \u0026lt;dbl\u0026gt;, mill \u0026lt;dbl\u0026gt;, moon \u0026lt;dbl\u0026gt;,\r## # mountain \u0026lt;dbl\u0026gt;, mountains \u0026lt;dbl\u0026gt;, night \u0026lt;dbl\u0026gt;, ocean \u0026lt;dbl\u0026gt;,\r## # oval_frame \u0026lt;dbl\u0026gt;, palm_trees \u0026lt;dbl\u0026gt;, path \u0026lt;dbl\u0026gt;, person \u0026lt;dbl\u0026gt;,\r## # portrait \u0026lt;dbl\u0026gt;, rectangle_3d_frame \u0026lt;dbl\u0026gt;, rectangular_frame \u0026lt;dbl\u0026gt;,\r## # river \u0026lt;dbl\u0026gt;, rocks \u0026lt;dbl\u0026gt;, seashell_frame \u0026lt;dbl\u0026gt;, snow \u0026lt;dbl\u0026gt;,\r## # snowy_mountain \u0026lt;dbl\u0026gt;, split_frame \u0026lt;dbl\u0026gt;, steve_ross \u0026lt;dbl\u0026gt;,\r## # structure \u0026lt;dbl\u0026gt;, sun \u0026lt;dbl\u0026gt;, tomb_frame \u0026lt;dbl\u0026gt;, tree \u0026lt;dbl\u0026gt;, trees \u0026lt;dbl\u0026gt;,\r## # triple_frame \u0026lt;dbl\u0026gt;, waterfall \u0026lt;dbl\u0026gt;, waves \u0026lt;dbl\u0026gt;, windmill \u0026lt;dbl\u0026gt;,\r## # window_frame \u0026lt;dbl\u0026gt;, winter \u0026lt;dbl\u0026gt;, wood_framed \u0026lt;dbl\u0026gt;\rTemos cada uma das 403 pinturas que Bob Ross fez ao longo dos 11 anos e 31 temporadas de The Joy of Painting, cada uma delas contendo os diversos elementos presentes em cada pintura: casas, barcos, palmeiras, árvores etc.\nPara organizar um pouco a tabela, vamos usar a função gather, colocando os diversos elementos em uma única coluna e sua existência ou não como outra coluna. Vamos também separar episódio e temporada em colunas próprias, numéricas, usando algumas funções do pacote stringr e um pouquinho de regex.\nbob_ross_gather \u0026lt;- bob_ross %\u0026gt;% separate(episode, into = c(\u0026quot;season\u0026quot;, \u0026quot;episode\u0026quot;), sep = \u0026quot;E\u0026quot;) %\u0026gt;% mutate(season = str_extract(season, \u0026quot;[:digit:]+\u0026quot;)) %\u0026gt;% mutate_at(vars(season, episode), as.integer) %\u0026gt;% gather(apple_frame:wood_framed, key = element, value = presence) %\u0026gt;% print()\r## # A tibble: 27,001 x 5\r## season episode title element presence\r## \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 1 1 \u0026quot;\\\u0026quot;A WALK IN THE WOODS\\\u0026quot;\u0026quot; apple_frame 0\r## 2 1 2 \u0026quot;\\\u0026quot;MT. MCKINLEY\\\u0026quot;\u0026quot; apple_frame 0\r## 3 1 3 \u0026quot;\\\u0026quot;EBONY SUNSET\\\u0026quot;\u0026quot; apple_frame 0\r## 4 1 4 \u0026quot;\\\u0026quot;WINTER MIST\\\u0026quot;\u0026quot; apple_frame 0\r## 5 1 5 \u0026quot;\\\u0026quot;QUIET STREAM\\\u0026quot;\u0026quot; apple_frame 0\r## 6 1 6 \u0026quot;\\\u0026quot;WINTER MOON\\\u0026quot;\u0026quot; apple_frame 0\r## 7 1 7 \u0026quot;\\\u0026quot;AUTUMN MOUNTAINS\\\u0026quot;\u0026quot; apple_frame 0\r## 8 1 8 \u0026quot;\\\u0026quot;PEACEFUL VALLEY\\\u0026quot;\u0026quot; apple_frame 0\r## 9 1 9 \u0026quot;\\\u0026quot;SEASCAPE\\\u0026quot;\u0026quot; apple_frame 0\r## 10 1 10 \u0026quot;\\\u0026quot;MOUNTAIN LAKE\\\u0026quot;\u0026quot; apple_frame 0\r## # ... with 26,991 more rows\rAgora vamos ver quais são os elementos mais presentes nas pinturas e separar os 20 primeiros.\ntop_elements \u0026lt;- bob_ross_gather %\u0026gt;% group_by(element) %\u0026gt;% summarise(presence = sum(presence)) %\u0026gt;% arrange(-presence) %\u0026gt;% top_n(20, presence) %\u0026gt;% mutate(element = factor(element, levels = element)) #transformando em factor para manter a ordem\rtop_elements %\u0026gt;% ggplot(aes(x = element, y = presence)) + geom_point(size=3) + geom_segment(aes(x = element, xend = element, y = 0, yend = presence)) + labs(x = NULL,\ry = \u0026quot;Nº de Pinturas\u0026quot;,\rtitle = \u0026quot;Elementos mais presentes nas pinturas de Bob Ross\u0026quot;, caption = \u0026quot;Fonte: Tidy Tuesday (https://github.com/rfordatascience/tidytuesday)\u0026quot;) + coord_flip() +\rtheme_bw()\rEm primeiro lugar, chamam atenção as árvores: 89% de suas pinturas contém ao menos uma árvore, e quase 84% delas possuem mais de uma. Curiosidade: uma vez que Bob pintasse a primeira árvore, ele não pintava a segunda, ele pintava uma “amiga” da primeira. Os dois próximos elementos da lista tratam dos tipos de árvores pintadas, decíduas e coníferas. Para os leigos: árvores que perdem folhas no inverno e pinheiros.\nEssa paisagem de coníferas e decíduas remete ao segundo tema mais constante da obra de Bob Ross, o inverno. Bob Ross ingressou na Força Aérea aos 17 anos (uma coisa que temos em comum). Diferente de mim, no entanto, ele continuou por lá, passando 20 anos na Base Aérea de Eielson, no Alasca. Isso parece ter permeado sua arte, uma vez que pinturas de áreas congeladas parece ter sido um trend em sua carreira. Montanhas nevadas, neve, inverno, são outros elementos constantes em sua obra.\n\rPuxando para o meu lado florestal, separei manualmente todas as referências a elementos vegetais nas obras de Bob. Se deixei passar algum, me avisem:\nveggies \u0026lt;- c(\u0026quot;bushes\u0026quot;, \u0026quot;cactus\u0026quot;, \u0026quot;conifer\u0026quot;, \u0026quot;deciduous\u0026quot;, \u0026quot;flowers\u0026quot;, \u0026quot;grass\u0026quot;,\u0026quot;palm_trees\u0026quot;, \u0026quot;tree\u0026quot;, \u0026quot;trees\u0026quot;)\rbob_ross_veg \u0026lt;- bob_ross_gather %\u0026gt;%\rfilter(element %in% veggies) bob_ross_veg %\u0026gt;%\rgroup_by(element) %\u0026gt;% summarise(presence = sum(presence)) %\u0026gt;% arrange(-presence) %\u0026gt;% mutate(element = factor(element, levels = element))%\u0026gt;% ggplot(aes(x = element, y = presence)) + geom_point(size=3) + geom_segment(aes(x = element, xend = element, y = 0, yend = presence)) + labs(x = NULL,\ry = \u0026quot;Nº de Pinturas\u0026quot;,\rtitle = \u0026quot;Elementos vegetais mais presentes nas pinturas de Bob Ross\u0026quot;, caption = \u0026quot;Fonte: Tidy Tuesday (https://github.com/rfordatascience/tidytuesday)\u0026quot;) + coord_flip() +\rtheme_bw()\rVamos dar uma olhada se algum desses elementos teve alguma grande alteração ao longo dos anos.\nbob_ross_veg %\u0026gt;%\rgroup_by(element, season) %\u0026gt;% summarise(presence = sum(presence)) %\u0026gt;% ungroup() %\u0026gt;% ggplot(aes(x = season, y = presence)) + geom_line(aes(color = element), show.legend = FALSE) + geom_smooth(method = \u0026quot;lm\u0026quot;, se = F, color = \u0026quot;lightgray\u0026quot;) +\rlabs(x = NULL,\ry = \u0026quot;Nº de Pinturas\u0026quot;,\rtitle = \u0026quot;Elementos vegetais mais presentes nas pinturas de Bob Ross ao longo do tempo\u0026quot;, caption = \u0026quot;Fonte: Tidy Tuesday (https://github.com/rfordatascience/tidytuesday)\u0026quot;) + facet_wrap(~element) +\rtheme_bw()\rAparentemente Bob Ross era bem consistente em suas pinturas. Também dá pra perceber a maior presença de plantas de climas mais frios (coníferas, decíduas) comparada à frequência daquelas de climas quentes (palmeiras, cactos). Isso continua nos mostrando como suas pinturas geralmente retratavam paisagens mais frias.\nDá pra notar uma diminuição do número de arbustos e árvores decíduas e um aumento das coníferas. Bob parece ter ido para climas ainda mais frios conforme o tempo passou!\nAbraços!\n","date":1565092472,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1565092472,"objectID":"a7972fb9277d90c25c00e454303264ca","permalink":"https://edgarcutar.github.io/post/2019-08-06-bob/","publishdate":"2019-08-06T08:54:32-03:00","relpermalink":"/post/2019-08-06-bob/","section":"post","summary":"A Tidy Tuesday dessa semana traz um dataset sobre Bob Ross. Bob foi um pintor americano conhecido pelo programa The Joy of Painting, que foi ao ar nos anos 80 e 90 nos EUA, Canadá e Europa. No seu programa, ele mostrava técnicas de pintura a óleo enquanto completava uma pintura toda semana.\nO dataset sobre o trabalho de Bob Ross foi fornecido para a #tidytuesday pelo site 538:","tags":["tidytuesday","bob-ross"],"title":"Uma Análise (Quase) Estatística De Bob Ross","type":"post"},{"authors":[],"categories":[],"content":"\rPerdido no Twitter há alguns dias, trombei com a base de dados “Women in Parliament” do World Bank Data, uma base imensa de dados mantida pelo Banco Mundial. Existe até um pacote para R, o wbstats.\nA base que queremos está disponível via wbstats e tem o código “SG.GEN.PARL.ZS”. Então vamos buscá-la através do pacote, puxando os dados desde 1997 (quando os dados começaram a ser coletados).\nif (!require(\u0026quot;pacman\u0026quot;)) install.packages(\u0026quot;pacman\u0026quot;)\r## Carregando pacotes exigidos: pacman\rpacman::p_load(tidyverse, scales,wbstats)\rwomen \u0026lt;- wbstats::wb(indicator = \u0026quot;SG.GEN.PARL.ZS\u0026quot;, startdate = 1997, enddate = 2018,\rcountry = \u0026quot;countries_only\u0026quot;)\rVamos dar uma olhada em como os dados estão estruturados:\nwomen %\u0026gt;% glimpse()\r## Observations: 3,971\r## Variables: 7\r## $ iso3c \u0026lt;chr\u0026gt; \u0026quot;AFG\u0026quot;, \u0026quot;AFG\u0026quot;, \u0026quot;AFG\u0026quot;, \u0026quot;AFG\u0026quot;, \u0026quot;AFG\u0026quot;, \u0026quot;AFG\u0026quot;, \u0026quot;AFG\u0026quot;, \u0026quot;...\r## $ date \u0026lt;chr\u0026gt; \u0026quot;2018\u0026quot;, \u0026quot;2017\u0026quot;, \u0026quot;2016\u0026quot;, \u0026quot;2015\u0026quot;, \u0026quot;2014\u0026quot;, \u0026quot;2013\u0026quot;, \u0026quot;2...\r## $ value \u0026lt;dbl\u0026gt; 27.7, 27.7, 27.7, 27.7, 27.7, 27.7, 27.7, 27.7, 27...\r## $ indicatorID \u0026lt;chr\u0026gt; \u0026quot;SG.GEN.PARL.ZS\u0026quot;, \u0026quot;SG.GEN.PARL.ZS\u0026quot;, \u0026quot;SG.GEN.PARL.Z...\r## $ indicator \u0026lt;chr\u0026gt; \u0026quot;Proportion of seats held by women in national par...\r## $ iso2c \u0026lt;chr\u0026gt; \u0026quot;AF\u0026quot;, \u0026quot;AF\u0026quot;, \u0026quot;AF\u0026quot;, \u0026quot;AF\u0026quot;, \u0026quot;AF\u0026quot;, \u0026quot;AF\u0026quot;, \u0026quot;AF\u0026quot;, \u0026quot;AF\u0026quot;, \u0026quot;A...\r## $ country \u0026lt;chr\u0026gt; \u0026quot;Afghanistan\u0026quot;, \u0026quot;Afghanistan\u0026quot;, \u0026quot;Afghanistan\u0026quot;, \u0026quot;Afgh...\rOk, cada país possui 22 linhas, de 1997 a 2018.\nEm primeiro lugar, eu gostaria de ver como a média mundial está se comportando desde 1997:\nmedia_mundo \u0026lt;- women %\u0026gt;% group_by(date) %\u0026gt;% summarise(media = mean(value)) media_mundo %\u0026gt;% ggplot(aes(x = date, y = media,\rgroup = 1)) +\rgeom_line() +\rtheme_minimal() +\rtheme(axis.text.x = element_text(angle = 30)) +\rlabs(title = \u0026quot;Percentual Médio de Mulheres nos Parlamentos Nacionais ao redor do mundo\u0026quot;,\ry = \u0026quot;%\u0026quot;,\rx = \u0026quot;Ano\u0026quot;,\rcaption = \u0026quot;Fonte: Banco Mundial - Elaborado por Edgar Cutar Junior\u0026quot;) +\rylim(0,25) \rBom, o resultado não é nada bom mas, pelo lado positivo, a média mais que dobrou em 20 anos.\nVamos ver a evolução dos mesmos dados usado o pacote ggridges, de Claus Wilke.\npacman::p_load(ggridges)\rwomen %\u0026gt;% mutate(date = factor(date, levels = 2018:1997)) %\u0026gt;% ggplot(aes(x = value, y = date,\rgroup = date)) +\rstat_density_ridges(bandwidth = 3, quantile_lines = TRUE, quantiles = 2,\rfill = \u0026quot;red\u0026quot;, alpha = 0.7) +\rlabs(title = \u0026quot;Distribuição de Mulheres nos Parlamentos Nacionais ao redor do mundo\u0026quot;,\ry = NULL,\rx = \u0026quot;%\u0026quot;,\rcaption = \u0026quot;Fonte: Banco Mundial - Elaborado por Edgar Cutar Junior\u0026quot;) +\rxlim(0,100) +\rscale_x_continuous(breaks = (0:10)*10) +\rtheme_minimal()\r## Scale for \u0026#39;x\u0026#39; is already present. Adding another scale for \u0026#39;x\u0026#39;, which\r## will replace the existing scale.\rNesse segundo gráfico temos um novo panorama, até menos animador. Embora em boa parte do mundo a situação parlamentar tenha evoluído, ainda existe uma boa quantidade de países em que o percentual ainda é muito baixo, abaixo de 10% das cadeiras sendo ocupadas por mulheres.\nPra finalizar, vamos dar uma olhada na situação do Brasil frente ao resto do mundo. Pra isso, vamos isolar a participação tupininquim das demais.\nbrasil \u0026lt;- women %\u0026gt;% group_by(date, isbrazil = country == \u0026quot;Brazil\u0026quot;) %\u0026gt;% summarise(media = mean(value)) brasil %\u0026gt;% ggplot(aes(x = date, y = media,\rgroup = isbrazil,\rcolor = isbrazil)) +\rgeom_line() +\rtheme_minimal() +\rtheme(axis.text.x = element_text(angle = 30)) +\rscale_color_viridis_d(end = 0.5, label = c(\u0026quot;Mundo\u0026quot;,\u0026quot;Brasil\u0026quot;)) +\rlabs(title = \u0026quot;Percentual Médio de Mulheres nos Parlamentos Nacionais ao redor do mundo\u0026quot;,\rsubtitle = \u0026quot;Brasil vs. Mundo\u0026quot;,\rcolor = NULL,\ry = \u0026quot;%\u0026quot;,\rx = \u0026quot;Ano\u0026quot;,\rcaption = \u0026quot;Fonte: Banco Mundial - Elaborado por Edgar Cutar Junior\u0026quot;) +\rylim(0,25) \rLembra que existiam países muito ruins no último gráfico? Infelizmente vivemos em um deles.\nwomen %\u0026gt;% filter(date == \u0026quot;2018\u0026quot;) %\u0026gt;% mutate(posicao = row_number(-value),\rpercentil = ntile(value, 100),\rnumero_de_paises = n()) %\u0026gt;% filter(country == \u0026quot;Brazil\u0026quot;) %\u0026gt;% select(country, posicao, percentil, numero_de_paises, value)\r## country posicao percentil numero_de_paises value\r## 1 Brazil 157 19 193 10.7\rO Brasil ocupa a 157ª posição de 193 países quando o assunto é a representatividade feminina nos parlamentos nacionais. Isso nos deixa no percentil 19, dentro do pior quartil.\nNão sei vocês, mas achei essa situação até pior do que eu achava que seria.\nEspero que isso leve todo mundo a refletir um pouco sobre o assunto.\nAté!\nPS: Resolvi plotar num mapa os dados de 2018… Tive que fazer alguns ajustes com nomes que não batiam, mas ficou assim:\nworld \u0026lt;- map_data(\u0026quot;world\u0026quot;) %\u0026gt;%\rmutate(region = case_when(region == \u0026quot;USA\u0026quot; ~ \u0026quot;United States\u0026quot;,\rregion == \u0026quot;Russia\u0026quot; ~ \u0026quot;Russian Federation\u0026quot;,\rregion == \u0026quot;Egypt\u0026quot; ~ \u0026quot;Egypt, Arab Rep.\u0026quot;,\rregion == \u0026quot;Venezuela\u0026quot; ~ \u0026quot;Venezuela, RB\u0026quot;,\rregion == \u0026quot;Democratic Republic of the Congo\u0026quot; ~ \u0026quot;Congo, Rep.\u0026quot;,\rregion == \u0026quot;Iran\u0026quot; ~ \u0026quot;Iran, Islamic Rep.\u0026quot;,\rregion == \u0026quot;Syria\u0026quot; ~ \u0026quot;Syrian Arab Republic\u0026quot;,\rregion == \u0026quot;Yemen\u0026quot; ~ \u0026quot;Yemen, Rep.\u0026quot;,\rTRUE ~ region)) %\u0026gt;% left_join(women %\u0026gt;% filter(date == 2018), by = c(\u0026quot;region\u0026quot; = \u0026quot;country\u0026quot;)) ggplot(world) +\rgeom_polygon(aes(x = long, y = lat, group = group, fill = value)) +\rscale_fill_viridis_c(direction = -1) +\rcoord_quickmap() +\rtheme_minimal() +\rlabs(x = NULL,\ry = NULL, fill = \u0026quot;% de Mulheres no Parlamento Nacional\u0026quot;,\rcaption = \u0026quot;Fonte: Banco Mundial - Elaborado por Edgar Cutar Junior\u0026quot;) +\rtheme(legend.position = \u0026quot;bottom\u0026quot;,\raxis.text = element_blank()) \r","date":1564358400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1564405056,"objectID":"f22a85d5dddce9a9e60b48b955f6a4bb","permalink":"https://edgarcutar.github.io/post/2019-07-29-mulheres/mulheres-no-parlamento-ao-redor-do-mundo/","publishdate":"2019-07-29T00:00:00Z","relpermalink":"/post/2019-07-29-mulheres/mulheres-no-parlamento-ao-redor-do-mundo/","section":"post","summary":"Perdido no Twitter há alguns dias, trombei com a base de dados “Women in Parliament” do World Bank Data, uma base imensa de dados mantida pelo Banco Mundial. Existe até um pacote para R, o wbstats.\nA base que queremos está disponível via wbstats e tem o código “SG.GEN.PARL.ZS”. Então vamos buscá-la através do pacote, puxando os dados desde 1997 (quando os dados começaram a ser coletados).\nif (!require(\u0026quot;pacman\u0026quot;)) install.","tags":[],"title":"Mulheres no Parlamento ao redor do mundo","type":"post"},{"authors":[],"categories":[],"content":"\rSobre o blog\rBom dia! Meu nome é Edgar Cutar Junior, eu sou engenheiro florestal e cada vez mais entusiasta do uso do R para análise de dados.\nCriei este blog inicialmente para participar da Tidy Tuesday. E não só participar, mas de alguma forma contribuir também.\n\rTidy Tuesday\rDesde 2017, existe um movimento iniciado por Jesse Maegan chamado R For Data Science Online Learning Community. O projeto todo gira em torno da comunidade (sempre vibrante) do R nas redes sociais, e como podemos utilizar dessas redes não só para nos comunicar como para nos ajudarmos uns aos outros.\nUm dos passos pra essa comunidade online se fortalecer é a Tidy Tuesday. E como isso funciona? Toda semana, na segunda feira, um banco de dados é postado no GitHub do projeto. A ideia é que o banco de dados seja um conjunto de dados de alguma forma abrangente sobre um assunto interessante (já foram publicados desde dados dos laureados no prêmio Nobel até uma lista de vinhos com seus ratings em sites especializados). Todos os dados já são organizados de forma a funcionar bem com o tidyverse.\nSabendo isso, a finalidade é pegar estes dados, manipular e gerar um único gráfico com uma informação retirada destes dados.\nDaí pra frente, é postar seu gráfico na terça feira (Tuesday!) com o código no Twitter com a hashtag #tidytuesday e correr pro abraço! E, claro, parte da experiência é interagir com as outras pessoas que também participam da Tidy Tuesday.\n\rOs finalmentes\rJá há tempos venho acompanhando o projeto e agora resolvi participar. E ao invés de só participar, resolvi criar esse blog onde vou dar o passo a passo de cada gráfico, toda semana (espero).\nAlém disso, eventualmente devo falar sobre alguma ferramenta ou base de dados que me chame a atenção.\nVocês podem me encontrar no meu e-mail, twitter e no Instagram.\nBem vindos!\n\r","date":1564358400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1564396372,"objectID":"a1c11c0c86636f360641adad8cd617ab","permalink":"https://edgarcutar.github.io/post/2019-07-29-sobre/sobre-este-blog-e-a-tidytuesday/","publishdate":"2019-07-29T00:00:00Z","relpermalink":"/post/2019-07-29-sobre/sobre-este-blog-e-a-tidytuesday/","section":"post","summary":"Sobre o blog\rBom dia! Meu nome é Edgar Cutar Junior, eu sou engenheiro florestal e cada vez mais entusiasta do uso do R para análise de dados.\nCriei este blog inicialmente para participar da Tidy Tuesday. E não só participar, mas de alguma forma contribuir também.\n\rTidy Tuesday\rDesde 2017, existe um movimento iniciado por Jesse Maegan chamado R For Data Science Online Learning Community. O projeto todo gira em torno da comunidade (sempre vibrante) do R nas redes sociais, e como podemos utilizar dessas redes não só para nos comunicar como para nos ajudarmos uns aos outros.","tags":[],"title":"Sobre este blog e a #tidytuesday","type":"post"}]